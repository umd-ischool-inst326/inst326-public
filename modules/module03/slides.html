<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui"><title>Checking your work: Basic principles of software testing</title><link rel="stylesheet" href="../../lib/reveal.js.3.9.2/css/reset.css"><link rel="stylesheet" href="../../lib/reveal.js.3.9.2/css/reveal.css"><link rel="stylesheet" href="../../lib/reveal.js.3.9.2/css/theme/black.css" id="theme"><!--This CSS is generated by the Asciidoctor reveal.js converter to further integrate AsciiDoc's existing semantic with reveal.js--><style type="text/css">.reveal div.right{float:right}

/* listing block */
.reveal .listingblock.stretch>.content{height: 100%}
.reveal .listingblock.stretch>.content>pre{height: 100%}
.reveal .listingblock.stretch>.content>pre>code{height:100%;max-height:100%}

/* tables */
table{border-collapse:collapse;border-spacing:0}
table{margin-bottom:1.25em;border:solid 1px #dedede}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
td.tableblock>.content{margin-bottom:1.25em}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
.reveal table th.halign-left,.reveal table td.halign-left{text-align:left}
.reveal table th.halign-right,.reveal table td.halign-right{text-align:right}
.reveal table th.halign-center,.reveal table td.halign-center{text-align:center}
.reveal table th.valign-top,.reveal table td.valign-top{vertical-align:top}
.reveal table th.valign-bottom,.reveal table td.valign-bottom{vertical-align:bottom}
.reveal table th.valign-middle,.reveal table td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{font-weight:bold}
thead{display:table-header-group}

.reveal table.grid-none th,.reveal table.grid-none td{border-bottom:0!important}

/* kbd macro */
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}

/* callouts */
.conum[data-value] {display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
/* Callout list */
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
/* Disabled from Asciidoctor CSS because it caused callout list to go under the
 * source listing when .stretch is applied (see #335)
 * .literalblock+.colist,.listingblock+.colist{margin-top:-.5em} */
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}

/* Override Asciidoctor CSS that causes issues with reveal.js features */
.reveal .hljs table{border: 0}
/* Callout list rows would have a bottom border with some reveal.js themes (see #335) */
.reveal .colist>table th, .reveal .colist>table td {border-bottom:0}
/* Fixes line height with Highlight.js source listing when linenums enabled (see #331) */
.reveal .hljs table thead tr th, .reveal .hljs table tfoot tr th, .reveal .hljs table tbody tr td, .reveal .hljs table tr td, .reveal .hljs table tfoot tr td{line-height:inherit}

/* Columns layout */
.columns .slide-content {
  display: flex;
}

.columns.wrap .slide-content {
  flex-wrap: wrap;
}

.columns.is-vcentered .slide-content {
  align-items: center;
}

.columns .slide-content > .column {
  display: block;
  flex-basis: 0;
  flex-grow: 1;
  flex-shrink: 1;
  padding: .75rem;
}

.columns .slide-content > .column.is-full {
  flex: none;
  width: 100%;
}

.columns .slide-content > .column.is-four-fifths {
  flex: none;
  width: 80%;
}

.columns .slide-content > .column.is-three-quarters {
  flex: none;
  width: 75%;
}

.columns .slide-content > .column.is-two-thirds {
  flex: none;
  width: 66.6666%;
}

.columns .slide-content > .column.is-three-fifths {
  flex: none;
  width: 60%;
}

.columns .slide-content > .column.is-half {
  flex: none;
  width: 50%;
}

.columns .slide-content > .column.is-two-fifths {
  flex: none;
  width: 40%;
}

.columns .slide-content > .column.is-one-third {
  flex: none;
  width: 33.3333%;
}

.columns .slide-content > .column.is-one-quarter {
  flex: none;
  width: 25%;
}

.columns .slide-content > .column.is-one-fifth {
  flex: none;
  width: 20%;
}
</style><!--Printing and PDF exports--><script>var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? "../../lib/reveal.js.3.9.2/css/print/pdf.css" : "../../lib/reveal.js.3.9.2/css/print/paper.css";
document.getElementsByTagName( 'head' )[0].appendChild( link );</script><link rel="stylesheet" href="../../css/aric_slides.css"></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title" data-background-image="images/antenna_test.jpg"><h1>Checking your work</h1><h2>Basic principles of software testing</h2></section><section><section id="_what_could_go_wrong" class="columns"><h2>What could go wrong?</h2><div class="slide-content"><div class="imageblock column fragment" style=""><img src="images/math_error.png" alt="math error"></div><div class="quoteblock column fragment"><blockquote>The problem here was not the error; it was the failure of NASA&#8217;s systems engineering, and the checks and balances in our processes, to detect the error. That&#8217;s why we lost the spacecraft.</blockquote><div class="attribution">&#8212; Edward Weiler, NASA associate administrator for space science</div></div><aside class="notes"><div class="paragraph"><p>The Mars Climate Orbiter was one of two main components of a $327.6 million dollar mission to study the atmosphere, climate, and surface of Mars. Built by NASA and Lockheed Martin, the probe was launched on Dec. 11, 1998. More than nine months and 669 million kilometers later, the orbiter reached its destination, but it failed to correctly insert itself into orbit around the planet. An investigation revealed that a program written by Lockheed was producing results in pound-force seconds; these results fed into a second program, written by NASA, which expected inputs in newton-seconds. NASA&#8217;s testing protocol somehow failed to detect this error, and it cost them the mission.</p></div></aside></div></section><section id="_what_could_go_wrong_2"><h2>What could go wrong?</h2><div class="slide-content"><div class="imageblock" style=""><img src="images/knight_capital_AP.png" alt="knight capital AP"></div>
<aside class="notes"><div class="paragraph"><p>On August 1, 2012, Knight Capital Group activated new automatic trading software on the New York Stock Exchange. In about 45 minutes, the software made millions of bad trades that ultimately cost the company $440 million and drained them of most of their capital. One of the key mistakes made by Knight&#8217;s IT team was leaving a piece of code called "Power Peg" in the code base. Power Peg was part of the software development team&#8217;s strategy for offline simulations. It was intended to cause the system to buy simulated stock at a high price and sell it at a lower price, in order to test certain aspects of the software. It was never intended to be used on the actual stock market. This one error destroyed 75% of Knight&#8217;s equity value. Experts agree that a more robust testing and deployment infrastructure could have prevented this catastrophe.</p></div></aside></div></section><section id="_what_could_go_wrong_3"><h2>What could go wrong?</h2><div class="slide-content"><div class="imageblock" style=""><img src="images/warehouse_hit_by_scud.jpg" alt="warehouse hit by scud"></div>
<aside class="notes"><div class="paragraph"><p>The Patriot is a surface-to-air missile system designed to intercept incoming missiles. The system was widely used in the Persian Gulf War of 1991, but on Feb. 25, it failed to intercept an incoming Iraqi Scud missile in Dhahran, Saudi Arabia. The Scud missile hit the Army barracks and killed 28 soldiers. Subsequent investigation identified a flaw in the way the system calculated time that had to do with converting integers to fixed-point real numbers. The conversion introduced a loss of precision that decreased the accuracy of the system in direct proportion to the amount of time since the system was last booted up. On that fateful day in February, the system had been operating for 100 hours, enough to cause the system to miscalculate the position of the incoming missile by 600 meters and mistake it for a false alarm. More rigorous testing could have detected this issue and saved lives.</p></div></aside></div></section><section id="_summary"><h2>Summary</h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>Sometimes little errors can cause big problems</p></li><li class="fragment"><p>A lot of problems can be prevented through careful testing</p></li></ul></div></div></section></section>
<section><section id="_kinds_of_tests"><h2>Kinds of tests</h2><div class="slide-content"><div class="ulist nosubbullet"><ul><li class="fragment"><p>Unit tests</p><div class="ulist"><ul><li><p>test components (functions) in isolation</p></li></ul></div></li><li class="fragment"><p>Integration tests</p><div class="ulist"><ul><li><p>test interfaces between components</p></li></ul></div></li><li class="fragment"><p>System tests</p><div class="ulist"><ul><li><p>test system functionality</p></li></ul></div></li></ul></div></div></section><section id="_test_cases"><h2>Test cases</h2><div class="slide-content"><div class="ulist nosubbullet"><ul><li class="fragment"><p>Happy path</p><div class="ulist"><ul><li><p>inputs and expected outputs are "normal"</p></li></ul></div></li><li class="fragment"><p>Edge cases ("unhappy path")</p><div class="ulist"><ul><li><p>inputs are unusual or special values</p></li><li><p>may trigger exceptions</p></li></ul></div></li></ul></div></div></section></section>
<section><section id="_assert_statements"><h2><code>assert</code> statements</h2><div class="slide-content"><div class="paragraph"><p><span class="fragment">An <code>assert</code> statement tells Python to verify an expression.</span> <span class="fragment">If the expression evaluates to <code>True</code> or a truthy value, the program continues.</span> <span class="fragment">Otherwise, an <code>AssertionError</code> is raised.</span></p></div><div class="paragraph fragment"><p>Two forms:</p></div><div class="ulist"><ul><li class="fragment"><p><code>assert</code> <span class="slot">expression</span></p><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">assert cube(3) == 27</code></pre></div></div></li><li class="fragment"><p><code>assert</code> <span class="slot">expression</span>, <span class="slot">error_msg</span></p><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">assert cube(3) == 27, \
    ("cube(3) returned"
     " unexpected result")</code></pre></div></div></li></ul></div><aside class="notes"><div class="paragraph"><p>An <code>assert</code> statement is a boolean context</p></div></aside></div></section><section id="_assert_in_action" class="columns"><h2><code>assert</code> in action</h2><div class="slide-content"><div class="openblock column fragment"><div class="content"><div class="imageblock" style=""><img src="images/annual_permit_fees.png" alt="annual permit fees"></div>
<div class="paragraph fragment"><p>Pretend we have a function <code>faculty_parking()</code> that takes an annual income and returns a permit fee.</p></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock fragment"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true"># some happy path cases
assert faculty_parking(25_000) == 494
assert faculty_parking(40_000) == 559
assert faculty_parking(50_000) == 627
assert faculty_parking(70_000) == 932
assert faculty_parking(90_000) == 986</code></pre></div></div>
<div class="listingblock fragment"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true"># some edge cases
assert faculty_parking(30_000) == 494
assert faculty_parking(30_001) == 559
# etc.</code></pre></div></div></div></div>
<aside class="notes"><div class="paragraph"><p>Imagine we want to write a function called <code>faculty_parking()</code> that calculates how much a faculty member will be charged for their parking based on the table above.</p></div>
<div class="paragraph"><p>We should have a few happy path cases. We don&#8217;t really need more than one of these per tier in the table&#8212;&#8203;additional tests would not tell us anything more about whether our code is behaving correctly.</p></div>
<div class="paragraph"><p>However, we should test a number of edge cases. In the case of this table, we should test the upper and lower bounds of each tier, because that&#8217;s where logic mistakes are most likely.</p></div></aside></div></section><section id="_testing_floating_point_values"><h2>Testing floating-point values</h2><div class="slide-content"><div class="paragraph"><p>True or false: <code>1/3 == (10/3)/10</code></p></div>
<div class="ulist"><ul><li class="fragment"><p>Floats can be imprecise (=inexact)</p></li><li class="fragment"><p>Calculations can result in additional loss of precision</p></li><li class="fragment"><p>We almost never care about the exact value of a float</p></li></ul></div>
<div class="paragraph fragment"><p>When testing floats, we almost always want to know if they are "close enough"</p></div></div></section><section id="_testing_floating_point_values_2"><h2>Testing floating-point values</h2><div class="slide-content"><div class="openblock fragment"><div class="content"><div class="paragraph"><p>What not to do:</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">assert myfloat == 0.3333333333333333</code></pre></div></div></div></div>
<div class="openblock fragment"><div class="content"><div class="paragraph"><p>What to do:</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">assert abs(myfloat - 0.3333333333333333) &lt;= 0.000000001</code></pre></div></div></div></div>
<div class="openblock fragment"><div class="content"><div class="paragraph"><p>Even better:</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">from math import isclose

assert isclose(myfloat, 0.3333333333333333)</code></pre></div></div></div></div></div></section><section id="_summary_2"><h2>Summary</h2><div class="slide-content"><div class="ulist nosubbullet"><ul><li class="fragment"><p><code>assert</code> statements tell Python to verify an expression</p></li><li class="fragment"><p>If the expression evaluates to <code>False</code> or a falsy value, an <code>AssertionError</code> is raised</p><div class="ulist"><ul><li><p>You can specify an error message to go along with an <code>AssertionError</code></p></li></ul></div></li><li class="fragment"><p>When testing floating-point values, we want to check for a "close" value rather than an exact value</p><div class="ulist"><ul><li><p><code>math.isclose()</code> is our friend</p></li></ul></div></li></ul></div></div></section></section>
<section><section id="_modules_part_1_reusing_other_peoples_work"><h2>Modules, part 1: reusing other people&#8217;s work</h2><div class="slide-content"><div class="ulist"><ul><li><p>Modules allow code to be reused in other programs</p></li><li><p>Some modules you may be familiar with:</p><div class="ulist"><ul><li><p><code>math</code></p></li><li><p><code>random</code></p></li><li><p><code>sys</code></p></li><li><p><code>pandas</code></p></li></ul></div></li></ul></div></div></section><section id="_import_statements_part_1"><h2><code>import</code> statements, part 1</h2><div class="slide-content"><div class="ulist"><ul><li><p><code>import</code> statements allow us to access code in a module</p></li><li><p><code>import</code> statements come in different flavors</p></li></ul></div>
<div class="openblock fragment"><div class="content"><div class="paragraph"><p>Flavor #1:</p></div>
<div class="paragraph"><p><code>import</code> <span class="slot">modulename</span></p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">import math
import statistics</code></pre></div></div></div></div>
<div class="openblock fragment"><div class="content"><div class="paragraph"><p>We can then access objects from the <code>math</code> module like this:</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">math.pi
math.sqrt(5)
statistics.stdev([1, 3, 2, 5, 6])</code></pre></div></div></div></div></div></section><section id="_namespaces"><h2>Namespaces</h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>When you import the <code>math</code> module, Python creates an object called <code>math</code> that contains the functions and constants defined in the module. This object is a <em>namespace</em>.</p></li><li class="fragment"><p>A namespace is a container for holding Python objects (functions, variables, etc.).</p></li><li class="fragment"><p>Namespaces help prevent <em>name collisions</em>.</p></li><li class="fragment"><p>Every program gets its own namespace: the <em>global namespace</em>.</p></li></ul></div></div></section><section id="_import_statements_part_2"><h2><code>import</code> statements, part 2</h2><div class="slide-content"><div class="paragraph"><p>Flavor #2:</p></div>
<div class="paragraph"><p><code>import</code> <span class="slot">modulename</span> <code>as</code> <span class="slot">othername</span></p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">import math as m
import statistics as stats

m.pi
m.sqrt(5)
stats.stdev([1, 3, 2, 5, 6])</code></pre></div></div>
<div class="paragraph"><p>Imports <span class="slot">modulename</span> but renames the namespace to <span class="slot">othername</span>.</p></div></div></section><section id="_import_statements_part_3"><h2><code>import</code> statements, part 3</h2><div class="slide-content"><div class="paragraph"><p>Flavor #3:</p></div>
<div class="paragraph"><p><code>from</code> <span class="slot">modulename</span> <code>import</code> <span class="slot">object</span> [, <span class="slot">object</span> &#8230;&#8203;]</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">from math import pi, sqrt
from statistics import stdev

pi
sqrt(5)
stdev([1, 3, 2, 5, 6])</code></pre></div></div>
<div class="paragraph"><p>Imports specific <span class="slot">object</span>s from <span class="slot">modulename</span> into the current (global) namespace.</p></div>
<div class="paragraph"><p>It&#8217;s okay to import multiple objects with a single <code>import</code> statement.</p></div></div></section><section id="_import_statements_part_4"><h2><code>import</code> statements, part 4</h2><div class="slide-content"><div class="paragraph"><p>Flavor #4:</p></div>
<div class="paragraph"><p><code>from</code> <span class="slot">modulename</span> <code>import</code> <span class="slot">object</span> <code>as</code> <span class="slot">othername</span> [, <span class="slot">object</span> <code>as</code> <span class="slot">othername</span> &#8230;&#8203;]</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">from math import pi as PI, sqrt as square_root
from statistics import stdev as st_dev

PI
square_root(5)
st_dev([1, 3, 2, 5, 6])</code></pre></div></div>
<div class="paragraph"><p>Imports specific <span class="slot">object</span>s from <span class="slot">modulename</span> into the current (global) namespace but renames them to <span class="slot">othername</span>.</p></div></div></section><section id="_import_statements_part_5"><h2><code>import</code> statements, part 5</h2><div class="slide-content"><div class="paragraph"><p>Flavor #5:</p></div>
<div class="paragraph"><p><code>from</code> <span class="slot">modulename</span> <code>import *</code></p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">from math import *
from statistics import *

pi
sqrt(5)
stdev([1, 3, 2, 5, 6])</code></pre></div></div>
<div class="paragraph"><p>Imports all objects from <span class="slot">modulename</span> into the current (global) namespace.</p></div>
<div class="ulist"><ul><li class="fragment"><p><span class="thumbsdown">Can clobber objects in your namespace</span></p></li><li class="fragment"><p><span class="thumbsdown">Obscures the origin of imported objects (where is <code>pi</code> defined?)</span></p></li></ul></div></div></section><section id="_summary_3"><h2>Summary</h2><div class="slide-content"><div class="ulist nosubbullet"><ul><li class="fragment"><p>Modules make it possible to package up code so it can be reused</p></li><li class="fragment"><p>There are several flavors of <code>import</code> statements for importing modules:</p><div class="ulist"><ul><li class="fragment"><p><code>import</code> <span class="slot">modulename</span></p></li><li class="fragment"><p><code>import</code> <span class="slot">modulename</span> <code>as</code> <span class="slot">othername</span></p></li><li class="fragment"><p><code>from</code> <span class="slot">modulename</span> <code>import</code> <span class="slot">object</span> [, <span class="slot">object</span> &#8230;&#8203;]</p></li><li class="fragment"><p><code>from</code> <span class="slot">modulename</span> <code>import</code> <span class="slot">object</span> <code>as</code> <span class="slot">othername</span> [, <span class="slot">object</span> <code>as</code> <span class="slot">othername</span> &#8230;&#8203;]</p></li><li class="fragment"><p><span class="thumbsdown"></span><code>from</code> <span class="slot">modulename</span> <code>import *</code></p></li></ul></div></li><li class="fragment"><p>The first two flavors of <code>import</code> statements create namespaces</p><div class="ulist"><ul><li><p>Namespaces are containers that help prevent name collisions</p></li></ul></div></li></ul></div></div></section></section>
<section><section id="_modules_part_2_now_its_personal"><h2>Modules, part 2: now it&#8217;s personal</h2><div class="slide-content"><div class="ulist nosubbullet"><ul><li class="fragment"><p>Turns out any script can be used as a module</p></li><li class="fragment"><p>Some scripts make better modules than others</p></li><li class="fragment"><p>We want most scripts we write to work as modules</p><div class="ulist"><ul><li class="fragment"><p><span class="thumbsup">Easier to test</span></p></li><li class="fragment"><p><span class="thumbsup">Can reuse functions</span></p></li></ul></div></li></ul></div></div></section><section id="_what_a_module_shouldnt_do"><h2>What a module <em>shouldn&#8217;t</em> do</h2><div class="slide-content"><div class="imageblock fragment" style=""><img src="images/surprise.png" alt="surprise"></div>
<aside class="notes"><div class="paragraph"><p>As a general rule, a module shouldn&#8217;t run any code when it is imported.</p></div>
<div class="paragraph"><p>Imagine you wrote a program that plays "Happy Birthday" and displays a fun animation on the screen. You want to be able to test the parts of your program, and you realize that some of the functions could be useful for playing other songs or animations. But how do you make it play songs and animations when it runs as a program, but not when it loads as a module?</p></div></aside></div></section><section id="_a_little_bit_of_magic"><h2>A little bit of magic</h2><div class="slide-content"><div class="paragraph"><p>A good program is</p></div>
<div class="ulist"><ul><li><p>99% definitions</p></li><li><p>1% instructions to do something</p></li></ul></div>
<div class="openblock fragment"><div class="content"><div class="paragraph"><p>Put the 1% inside the following statement:</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">if __name__ == "__main__":
    # instructions go here</code></pre></div></div></div></div>
<aside class="notes"><div class="paragraph"><p>The instructions will run when your script runs as the main program. They won&#8217;t run when your script is imported as a module.</p></div>
<div class="paragraph"><p>Those big long lines are two underscores. The Python community has a special name for two underscores in a row: "dunder".</p></div></aside></div></section><section id="_decoding_the_magic"><h2>Decoding the magic</h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>Whenever Python loads a script, it creates a special variable, <code>__name__</code></p></li><li class="fragment"><p>For modules, <code>__name__</code> is the name of the module</p></li><li class="fragment"><p>For the main script, <code>__name__</code> gets the special value <code>"__main__"</code></p></li></ul></div>
<div class="openblock fragment"><div class="content"><div class="paragraph"><p>Bottom line: the value of <code>__name__</code> will be different depending on whether your script was run or imported.</p></div></div></div>
<aside class="notes"><div class="paragraph"><p>Demonstrate <em>name</em> in an interactive interpreter.</p></div></aside></div></section><section id="_summary_4"><h2>Summary</h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>We want to write scripts that work as both programs and modules</p></li><li class="fragment"><p>Modules generally shouldn&#8217;t execute code when they are loaded</p></li><li class="fragment"><p><code>if __name__ == "__main__":</code> helps you isolate instructions that should only run when your program runs.</p></li></ul></div></div></section></section>
<section><section id="_pytest"><h2>Pytest</h2><div class="slide-content"><div class="ulist"><ul><li><p>Pytest is a popular testing framework for Python</p></li><li><p>If you can import a module and write functions and <code>assert</code> statements, you can use Pytest</p></li></ul></div></div></section><section id="_example_script_to_test" class="columns"><h2>Example script to test</h2><div class="slide-content"><div class="openblock column"><div class="title">facparking.py</div><div class="content"><div class="listingblock fullwidth"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">import sys

def faculty_parking(income):
    """ Determine the cost of faculty
    parking based on a faculty member's
    annual salary. """
    return (494 if income &lt; 30_001 else
            559 if income &lt; 45_001 else
            627 if income &lt; 60_001 else
            932 if income &lt; 80_001 else
            986)</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock fullwidth"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">if __name__ == "__main__":
    try:
        income = int(sys.argv[1])
    except IndexError:
        print("Please provide your income"
              " as a command-line argument")
    except ValueError:
        print("Please provide your income"
              " as an integer as the first"
              " command-line argument")
    print("You would pay",
          faculty_parking(income),
          "for an annual parking pass")</code></pre></div></div></div></div></div></section><section id="_example_pytest_test_script" class="columns"><h2>Example Pytest test script</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock fullwidth"><div class="title">test_facparking.py</div>
<div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">import facparking as fp

def test_faculty_parking_happy_path():
    """ some happy path cases to test
    faculty_parking() """
    assert fp.faculty_parking(25_000) == 494
    assert fp.faculty_parking(40_000) == 559
    assert fp.faculty_parking(50_000) == 627
    assert fp.faculty_parking(70_000) == 932
    assert fp.faculty_parking(90_000) == 986</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock fullwidth"><div class="content"><pre class="highlightjs highlight"><code data-lang="python" class="language-python hljs" data-noescape="true">def test_faculty_parking_edge_cases():
    """ some edge cases to test
    faculty_parking() """
    assert fp.faculty_parking(30_000) == 494
    assert fp.faculty_parking(30_001) == 559
    # etc.</code></pre></div></div></div></div></div></section><section id="_running_your_tests"><h2>Running your tests</h2><div class="slide-content"><div class="paragraph"><p>The following instructions assume you have Pytest installed.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Open a terminal in the directory where your script and test script live.</p></li><li><p>Type <code>pytest</code> followed by a space and the name of your test script, e.g.:<br>
<code>pytest test_facparking.py</code></p></li></ol></div></div></section><section id="_interpreting_the_output_passed_all_tests"><h2>Interpreting the output: passed all tests</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre>========================== test session starts ===========================
platform linux -- Python 3.8.2, pytest-6.0.1, py-1.9.0, pluggy-0.13.1
rootdir: /home/aric/Documents/INST326/2020_fall/module03
collected 2 items

test_facparking.py ..                                              [100%]

=========================== 2 passed in 0.00s ============================</pre></div></div></div></section><section id="_interpreting_the_output_failed_test"><h2>Interpreting the output: failed test</h2><div class="slide-content"><pre class="fragment">
========================== test session starts ===========================
platform linux -- Python 3.8.2, pytest-6.0.1, py-1.9.0, pluggy-0.13.1
rootdir: /home/aric/Documents/INST326/2020_fall/module03
collected 2 items

test_facparking.py F.                                              [100%]
</pre>
<pre class="fragment">
================================ FAILURES ================================
____________________ test_faculty_parking_happy_path _____________________

    def test_faculty_parking_happy_path():
        """ some happy path cases to test
        faculty_parking() """
        assert fp.faculty_parking(25_000) == 494
>       assert fp.faculty_parking(40_000) == 559
E       assert 550 == 559
E        +  where 550 = <function faculty_parking at 0x7f1114b443a0>(40000)
E        +    where <function faculty_parking at 0x7f1114b443a0> = fp.faculty_parking

test_facparking.py:7: AssertionError
</pre>
<pre class="fragment">
======================== short test summary info =========================
FAILED test_facparking.py::test_faculty_parking_happy_path - assert 550...
====================== 1 failed, 1 passed in 0.02s =======================
</pre></div></section><section id="_two_ways_a_test_can_fail"><h2>Two ways a test can fail</h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>There can be an error in the code being tested</p></li><li class="fragment"><p>There can be an error in the test code</p></li></ul></div></div></section><section id="_i_passed_all_tests_my_code_is_perfect_right"><h2>I passed all tests! My code is perfect, right?</h2><div class="slide-content"><div class="ulist"><ul><li><p>Passing tests is not a guarantee of correctness</p></li><li><p>The better your test set, the more confidence you can have in your code</p></li></ul></div></div></section><section id="_summary_5"><h2>Summary</h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>Pytest is a popular, easy-to-use test framework for Python</p></li><li class="fragment"><p>Tests go in fuctions whose names start with <code>test</code></p></li><li class="fragment"><p>Tests are built on <code>assert</code> statements</p></li></ul></div></div></section></section><script>
    function transitions() {
        const transitionlist = ["fade-in", "fade-out", "slide-in", "slide-out", "none-in", "none-out", "none"]
        for (const transition of transitionlist) {
            const elements = document.getElementsByClassName(transition);
            for (const element of elements) {
                // console.log(element);
                var attr = element.getAttribute("data-transition");
                if (typeof attr == "string" && attr.length) {
                    attr += " " + transition;
                } else {
                    attr = transition;
                }
                element.setAttribute("data-transition", attr);
            }
        }
    }

    function styleListItems() {
        const stylelist = ["thumbsup", "thumbsdown"];
        for (const style of stylelist) {
            const elements = document.getElementsByClassName(style);
            for (const element of elements) {
                // console.log(element);
                element.closest("li").classList.add(style);
            }
        }
    }
    styleListItems();
    transitions();
</script></div></div><script src="../../lib/reveal.js.3.9.2/js/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
});

// More info about config & dependencies:
// - https://github.com/hakimel/reveal.js#configuration
// - https://github.com/hakimel/reveal.js#dependencies
Reveal.initialize({
  // Display presentation control arrows
  controls: true,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: false,
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Add the current slide number to the URL hash so that reloading the
  // page/copying the URL will return you to the same slide
  hash: false,
  // Push each slide change to the browser history. Implies `hash: true`
  history: false,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // See https://github.com/hakimel/reveal.js/#navigation-mode
  navigationMode: 'default',
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Global override for preloading lazy-loaded iframes
  // - null: Iframes with data-src AND data-preload will be loaded when within
  //   the viewDistance, iframes with only data-src will be loaded when visible
  // - true: All iframes with data-src will be loaded when within the viewDistance
  // - false: All iframes with data-src will be loaded only when visible
  preloadIframes: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Specify the total time in seconds that is available to
  // present.  If this is set to a nonzero value, the pacing
  // timer will work out the time available for each slide,
  // instead of using the defaultTiming value
  totalTime: 0,
  // Specify the minimum amount of time you want to allot to
  // each slide, if using the totalTime calculation method.  If
  // the automated time allocation causes slide pacing to fall
  // below this threshold, then you will see an alert in the
  // speaker notes window
  minimumTimePerSlide: 0,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hide cursor if inactive
  hideInactiveCursor: true,
  // Time before the cursor is hidden (in ms)
  hideCursorTime: 5000,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'slide',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Number of slides away from the current that are visible on mobile
  // devices. It is advisable to set this to a lower number than
  // viewDistance in order to save resources.
  mobileViewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1400,
  height: 810,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // PDF Export Options
  // Put each fragment on a separate page
  pdfSeparateFragments: true,
  // For slides that do not fit on a page, max number of pages
  pdfMaxPagesPerSlide: 1,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: '../../lib/reveal.js.3.9.2/plugin/zoom-js/zoom.js', async: true },
      { src: '../../lib/reveal.js.3.9.2/plugin/notes/notes.js', async: true }
  ],

  

});</script><script>var dom = {};
dom.slides = document.querySelector('.reveal .slides');

function getRemainingHeight(element, slideElement, height) {
  height = height || 0;
  if (element) {
    var newHeight, oldHeight = element.style.height;
    // Change the .stretch element height to 0 in order find the height of all
    // the other elements
    element.style.height = '0px';
    // In Overview mode, the parent (.slide) height is set of 700px.
    // Restore it temporarily to its natural height.
    slideElement.style.height = 'auto';
    newHeight = height - slideElement.offsetHeight;
    // Restore the old height, just in case
    element.style.height = oldHeight + 'px';
    // Clear the parent (.slide) height. .removeProperty works in IE9+
    slideElement.style.removeProperty('height');
    return newHeight;
  }
  return height;
}

function layoutSlideContents(width, height) {
  // Handle sizing of elements with the 'stretch' class
  toArray(dom.slides.querySelectorAll('section .stretch')).forEach(function (element) {
    // Determine how much vertical space we can use
    var limit = 5; // hard limit
    var parent = element.parentNode;
    while (parent.nodeName !== 'SECTION' && limit > 0) {
      parent = parent.parentNode;
      limit--;
    }
    if (limit === 0) {
      // unable to find parent, aborting!
      return;
    }
    var remainingHeight = getRemainingHeight(element, parent, height);
    // Consider the aspect ratio of media elements
    if (/(img|video)/gi.test(element.nodeName)) {
      var nw = element.naturalWidth || element.videoWidth, nh = element.naturalHeight || element.videoHeight;
      var es = Math.min(width / nw, remainingHeight / nh);
      element.style.width = (nw * es) + 'px';
      element.style.height = (nh * es) + 'px';
    } else {
      element.style.width = width + 'px';
      element.style.height = remainingHeight + 'px';
    }
  });
}

function toArray(o) {
  return Array.prototype.slice.call(o);
}

Reveal.addEventListener('slidechanged', function () {
  layoutSlideContents(1400, 810)
});
Reveal.addEventListener('ready', function () {
  layoutSlideContents(1400, 810)
});
Reveal.addEventListener('resize', function () {
  layoutSlideContents(1400, 810)
});</script><link rel="stylesheet" href="../../lib/reveal.js.3.9.2/lib/css/monokai.css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>

<script>

/* highlightjs-line-numbers.js 2.6.0 | (C) 2018 Yauheni Pakala | MIT License | github.com/wcoder/highlightjs-line-numbers.js */
/* Edited by Hakim for reveal.js; removed async timeout */
!function(n,e){"use strict";function t(){var n=e.createElement("style");n.type="text/css",n.innerHTML=g(".{0}{border-collapse:collapse}.{0} td{padding:0}.{1}:before{content:attr({2})}",[v,L,b]),e.getElementsByTagName("head")[0].appendChild(n)}function r(t){"interactive"===e.readyState||"complete"===e.readyState?i(t):n.addEventListener("DOMContentLoaded",function(){i(t)})}function i(t){try{var r=e.querySelectorAll("code.hljs,code.nohighlight");for(var i in r)r.hasOwnProperty(i)&&l(r[i],t)}catch(o){n.console.error("LineNumbers error: ",o)}}function l(n,e){"object"==typeof n&&f(function(){n.innerHTML=s(n,e)})}function o(n,e){if("string"==typeof n){var t=document.createElement("code");return t.innerHTML=n,s(t,e)}}function s(n,e){e=e||{singleLine:!1};var t=e.singleLine?0:1;return c(n),a(n.innerHTML,t)}function a(n,e){var t=u(n);if(""===t[t.length-1].trim()&&t.pop(),t.length>e){for(var r="",i=0,l=t.length;i<l;i++)r+=g('<tr><td class="{0}"><div class="{1} {2}" {3}="{5}"></div></td><td class="{4}"><div class="{1}">{6}</div></td></tr>',[j,m,L,b,p,i+1,t[i].length>0?t[i]:" "]);return g('<table class="{0}">{1}</table>',[v,r])}return n}function c(n){var e=n.childNodes;for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];h(r.textContent)>0&&(r.childNodes.length>0?c(r):d(r.parentNode))}}function d(n){var e=n.className;if(/hljs-/.test(e)){for(var t=u(n.innerHTML),r=0,i="";r<t.length;r++){var l=t[r].length>0?t[r]:" ";i+=g('<span class="{0}">{1}</span>\n',[e,l])}n.innerHTML=i.trim()}}function u(n){return 0===n.length?[]:n.split(y)}function h(n){return(n.trim().match(y)||[]).length}function f(e){e()}function g(n,e){return n.replace(/{(\d+)}/g,function(n,t){return e[t]?e[t]:n})}var v="hljs-ln",m="hljs-ln-line",p="hljs-ln-code",j="hljs-ln-numbers",L="hljs-ln-n",b="data-line-number",y=/\r\n|\r|\n/g;n.hljs?(n.hljs.initLineNumbersOnLoad=r,n.hljs.lineNumbersBlock=l,n.hljs.lineNumbersValue=o,t()):n.console.error("highlight.js not detected!")}(window,document);

/**
 * This reveal.js plugin is wrapper around the highlight.js
 * syntax highlighting library.
 */
(function( root, factory ) {
  if (typeof define === 'function' && define.amd) {
    root.RevealHighlight = factory();
  } else if( typeof exports === 'object' ) {
    module.exports = factory();
  } else {
    // Browser globals (root is window)
    root.RevealHighlight = factory();
  }
}( this, function() {

  // Function to perform a better "data-trim" on code snippets
  // Will slice an indentation amount on each line of the snippet (amount based on the line having the lowest indentation length)
  function betterTrim(snippetEl) {
    // Helper functions
    function trimLeft(val) {
      // Adapted from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim#Polyfill
      return val.replace(/^[\s\uFEFF\xA0]+/g, '');
    }
    function trimLineBreaks(input) {
      var lines = input.split('\n');

      // Trim line-breaks from the beginning
      for (var i = 0; i < lines.length; i++) {
        if (lines[i].trim() === '') {
          lines.splice(i--, 1);
        } else break;
      }

      // Trim line-breaks from the end
      for (var i = lines.length-1; i >= 0; i--) {
        if (lines[i].trim() === '') {
          lines.splice(i, 1);
        } else break;
      }

      return lines.join('\n');
    }

    // Main function for betterTrim()
    return (function(snippetEl) {
      var content = trimLineBreaks(snippetEl.innerHTML);
      var lines = content.split('\n');
      // Calculate the minimum amount to remove on each line start of the snippet (can be 0)
      var pad = lines.reduce(function(acc, line) {
        if (line.length > 0 && trimLeft(line).length > 0 && acc > line.length - trimLeft(line).length) {
          return line.length - trimLeft(line).length;
        }
        return acc;
      }, Number.POSITIVE_INFINITY);
      // Slice each line with this amount
      return lines.map(function(line, index) {
        return line.slice(pad);
      })
        .join('\n');
    })(snippetEl);
  }

  var RevealHighlight = {

    HIGHLIGHT_STEP_DELIMITER: '|',
    HIGHLIGHT_LINE_DELIMITER: ',',
    HIGHLIGHT_LINE_RANGE_DELIMITER: '-',

    init: function() {

      // Read the plugin config options and provide fallbacks
      var config = Reveal.getConfig().highlight || {};
      config.highlightOnLoad = typeof config.highlightOnLoad === 'boolean' ? config.highlightOnLoad : true;
      config.escapeHTML = typeof config.escapeHTML === 'boolean' ? config.escapeHTML : true;

      [].slice.call( document.querySelectorAll( '.reveal pre code' ) ).forEach( function( block ) {

        // Trim whitespace if the "data-trim" attribute is present
        if( block.hasAttribute( 'data-trim' ) && typeof block.innerHTML.trim === 'function' ) {
          block.innerHTML = betterTrim( block );
        }

        // Escape HTML tags unless the "data-noescape" attrbute is present
        if( config.escapeHTML && !block.hasAttribute( 'data-noescape' )) {
          block.innerHTML = block.innerHTML.replace( /</g,"&lt;").replace(/>/g, '&gt;' );
        }

        // Re-highlight when focus is lost (for contenteditable code)
        block.addEventListener( 'focusout', function( event ) {
          hljs.highlightBlock( event.currentTarget );
        }, false );

        if( config.highlightOnLoad ) {
          RevealHighlight.highlightBlock( block );
        }
      } );

    },

    /**
     * Highlights a code block. If the <code> node has the
     * 'data-line-numbers' attribute we also generate slide
     * numbers.
     *
     * If the block contains multiple line highlight steps,
     * we clone the block and create a fragment for each step.
     */
    highlightBlock: function( block ) {

      hljs.highlightBlock( block );

      // Don't generate line numbers for empty code blocks
      if( block.innerHTML.trim().length === 0 ) return;

      if( block.hasAttribute( 'data-line-numbers' ) ) {
        hljs.lineNumbersBlock( block, { singleLine: true } );

        // If there is at least one highlight step, generate
        // fragments
        var highlightSteps = RevealHighlight.deserializeHighlightSteps( block.getAttribute( 'data-line-numbers' ) );
        if( highlightSteps.length > 1 ) {

          // If the original code block has a fragment-index,
          // each clone should follow in an incremental sequence
          var fragmentIndex = parseInt( block.getAttribute( 'data-fragment-index' ), 10 );
          if( typeof fragmentIndex !== 'number' || isNaN( fragmentIndex ) ) {
            fragmentIndex = null;
          }

          // Generate fragments for all steps except the original block
          highlightSteps.slice(1).forEach( function( highlight ) {

            var fragmentBlock = block.cloneNode( true );
            fragmentBlock.setAttribute( 'data-line-numbers', RevealHighlight.serializeHighlightSteps( [ highlight ] ) );
            fragmentBlock.classList.add( 'fragment' );
            block.parentNode.appendChild( fragmentBlock );
            RevealHighlight.highlightLines( fragmentBlock );

            if( typeof fragmentIndex === 'number' ) {
              fragmentBlock.setAttribute( 'data-fragment-index', fragmentIndex );
              fragmentIndex += 1;
            }
            else {
              fragmentBlock.removeAttribute( 'data-fragment-index' );
            }

          } );

          block.removeAttribute( 'data-fragment-index' )
          block.setAttribute( 'data-line-numbers', RevealHighlight.serializeHighlightSteps( [ highlightSteps[0] ] ) );

        }

        RevealHighlight.highlightLines( block );

      }

    },

    /**
     * Visually emphasize specific lines within a code block.
     * This only works on blocks with line numbering turned on.
     *
     * @param {HTMLElement} block a <code> block
     * @param {String} [linesToHighlight] The lines that should be
     * highlighted in this format:
     * "1" 		= highlights line 1
     * "2,5"	= highlights lines 2 & 5
     * "2,5-7"	= highlights lines 2, 5, 6 & 7
     */
    highlightLines: function( block, linesToHighlight ) {

      var highlightSteps = RevealHighlight.deserializeHighlightSteps( linesToHighlight || block.getAttribute( 'data-line-numbers' ) );

      if( highlightSteps.length ) {

        highlightSteps[0].forEach( function( highlight ) {

          var elementsToHighlight = [];

          // Highlight a range
          if( typeof highlight.end === 'number' ) {
            elementsToHighlight = [].slice.call( block.querySelectorAll( 'table tr:nth-child(n+'+highlight.start+'):nth-child(-n+'+highlight.end+')' ) );
          }
          // Highlight a single line
          else if( typeof highlight.start === 'number' ) {
            elementsToHighlight = [].slice.call( block.querySelectorAll( 'table tr:nth-child('+highlight.start+')' ) );
          }

          if( elementsToHighlight.length ) {
            elementsToHighlight.forEach( function( lineElement ) {
              lineElement.classList.add( 'highlight-line' );
            } );

            block.classList.add( 'has-highlights' );
          }

        } );

      }

    },

    /**
     * Parses and formats a user-defined string of line
     * numbers to highlight.
     *
     * @example
     * RevealHighlight.deserializeHighlightSteps( '1,2|3,5-10' )
     * // [
     * //   [ { start: 1 }, { start: 2 } ],
     * //   [ { start: 3 }, { start: 5, end: 10 } ]
     * // ]
     */
    deserializeHighlightSteps: function( highlightSteps ) {

      // Remove whitespace
      highlightSteps = highlightSteps.replace( /\s/g, '' );

      // Divide up our line number groups
      highlightSteps = highlightSteps.split( RevealHighlight.HIGHLIGHT_STEP_DELIMITER );

      return highlightSteps.map( function( highlights ) {

        return highlights.split( RevealHighlight.HIGHLIGHT_LINE_DELIMITER ).map( function( highlight ) {

          // Parse valid line numbers
          if( /^[\d-]+$/.test( highlight ) ) {

            highlight = highlight.split( RevealHighlight.HIGHLIGHT_LINE_RANGE_DELIMITER );

            var lineStart = parseInt( highlight[0], 10 ),
              lineEnd = parseInt( highlight[1], 10 );

            if( isNaN( lineEnd ) ) {
              return {
                start: lineStart
              };
            }
            else {
              return {
                start: lineStart,
                end: lineEnd
              };
            }

          }
          // If no line numbers are provided, no code will be highlighted
          else {

            return {};

          }

        } );

      } );

    },

    /**
     * Serializes parsed line number data into a string so
     * that we can store it in the DOM.
     */
    serializeHighlightSteps: function( highlightSteps ) {

      return highlightSteps.map( function( highlights ) {

        return highlights.map( function( highlight ) {

          // Line range
          if( typeof highlight.end === 'number' ) {
            return highlight.start + RevealHighlight.HIGHLIGHT_LINE_RANGE_DELIMITER + highlight.end;
          }
          // Single line
          else if( typeof highlight.start === 'number' ) {
            return highlight.start;
          }
          // All lines
          else {
            return '';
          }

        } ).join( RevealHighlight.HIGHLIGHT_LINE_DELIMITER );

      } ).join( RevealHighlight.HIGHLIGHT_STEP_DELIMITER );

    }

  }

  Reveal.registerPlugin( 'highlight', RevealHighlight );

  return RevealHighlight;

}));
        
hljs.initHighlightingOnLoad();
</script></body></html>